# 카카오 비즈메시지 설정 가이드

## 1. 카카오톡 채널 생성

### 1.1 카카오 비즈니스 가입
1. https://business.kakao.com/ 접속
2. 카카오 계정으로 로그인
3. 비즈니스 등록

### 1.2 카카오톡 채널 생성
1. [카카오톡 채널 관리자센터](https://center-pf.kakao.com/) 접속
2. "새 채널 만들기" 클릭
3. 채널 정보 입력:
   - 채널명
   - 프로필 사진
   - 소개글
4. 채널 생성 완료

---

## 2. 알림톡 발신 프로필 등록

### 2.1 발신 프로필 신청
1. 채널 관리자센터 → 비즈니스 도구 → 알림톡
2. "발신프로필 등록" 클릭
3. 필요 정보 입력:
   - 사업자등록번호 (사업자의 경우)
   - 발신 프로필명
   - 카테고리 선택

### 2.2 검수 과정
- 검수 기간: 1-3 영업일
- 상태 확인: 채널 관리자센터에서 확인

---

## 3. 알림톡 템플릿 등록

### 3.1 템플릿 생성
1. 채널 관리자센터 → 알림톡 → 템플릿 관리
2. "템플릿 등록" 클릭

### 3.2 템플릿 내용 (예시)

**템플릿 명**: 예약확인안내

**템플릿 내용**:
```
[예약 확인 안내]

안녕하세요, #{예약자명}님

예약이 확인되었습니다.

■ 예약 일시: #{예약일시}
■ 예약 내용: #{예약내용}

문의사항은 연락 부탁드립니다.
감사합니다.
```

### 3.3 변수 설명
| 변수명 | 설명 | 예시 |
|--------|------|------|
| #{예약자명} | 예약자 이름 | 홍길동 |
| #{예약일시} | 예약 날짜/시간 | 2025-01-28 14:00 |
| #{예약내용} | 예약 상세 내용 | 체험 프로그램 |

### 3.4 템플릿 검수
- 검수 기간: 1-2 영업일
- 승인 후 템플릿 코드 확인

---

## 4. API 연동 설정

### 4.1 카카오 개발자 앱 생성
1. [Kakao Developers](https://developers.kakao.com/) 접속
2. 내 애플리케이션 → 애플리케이션 추가
3. 앱 이름 입력 후 생성

### 4.2 API 키 확인
앱 설정 → 앱 키에서 확인:
- **REST API 키**: 일반 API 호출용
- **Admin 키**: 알림톡 발송용 (중요!)

### 4.3 알림톡 발송 권한 설정
1. 앱 설정 → 비즈앱 전환
2. 사업자 정보 등록
3. 알림톡 발송 권한 신청

---

## 5. API 호출 예시

### 5.1 알림톡 발송 (비즈메시지 API)

**Endpoint**:
```
POST https://kapi.kakao.com/v1/api/talk/friends/message/send
```

**Headers**:
```
Authorization: KakaoAK {ADMIN_KEY}
Content-Type: application/x-www-form-urlencoded
```

**Body**:
```
receiver_uuids=["uuid1","uuid2"]
template_id={TEMPLATE_ID}
template_args={"예약자명":"홍길동","예약일시":"2025-01-28 14:00","예약내용":"체험"}
```

### 5.2 솔라피/NHN Cloud 대안

카카오 직접 연동이 복잡하면 중개 서비스 사용 가능:

**솔라피 (Solapi)**:
- 더 간단한 API
- 대량 발송 지원
- https://solapi.com/

**NHN Cloud**:
- 안정적인 인프라
- https://www.nhncloud.com/

---

## 6. 주의사항

1. **발신번호 등록**: 알림톡 발송 전 발신번호 사전등록 필요
2. **템플릿 준수**: 승인된 템플릿만 사용 가능
3. **수신 동의**: 예약자의 수신 동의 필요
4. **발송 제한**: 1일 발송량 제한 있음 (채널 등급에 따라 다름)

---

## 7. 트러블슈팅

### 템플릿 반려 사유
- 변수 형식 오류
- 부적절한 내용
- 광고성 문구 포함

### API 오류 코드
| 코드 | 설명 | 해결 |
|------|------|------|
| -401 | 인증 실패 | Admin 키 확인 |
| -402 | 템플릿 없음 | 템플릿 ID 확인 |
| -403 | 권한 없음 | 비즈앱 권한 확인 |
